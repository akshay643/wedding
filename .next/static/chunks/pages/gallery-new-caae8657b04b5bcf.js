(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[828],{1707:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/gallery-new",function(){return a(4250)}])},2550:function(e,t,a){"use strict";var l=a(5893),n=a(7294),s=a(1163);t.Z=e=>t=>{let[a,i]=(0,n.useState)(!1),[r,c]=(0,n.useState)(!0),o=(0,s.useRouter)();(0,n.useEffect)(()=>{checkAuth()},[]);let checkAuth=async()=>{try{let e=await fetch("/api/auth/verify");e.ok?i(!0):o.push("/login")}catch(e){o.push("/login")}finally{c(!1)}};return r?(0,l.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-pink-50 to-orange-50 flex items-center justify-center",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"w-16 h-16 border-4 border-pink-200 border-t-pink-500 rounded-full animate-spin mx-auto mb-4"}),(0,l.jsx)("p",{className:"text-gray-600",children:"Checking authentication..."})]})}):a?(0,l.jsx)(e,{...t}):null}},4250:function(e,t,a){"use strict";a.r(t);var l=a(5893),n=a(7294),s=a(1590),i=a(9464),r=a(7831),c=a(3079),o=a(7259),d=a(2600),u=a(2550);let h=[{id:"all",name:"All Events"},{id:"mehndi",name:"Mehndi"},{id:"haldi",name:"Haldi"},{id:"dj-night",name:"DJ Night"},{id:"wedding",name:"Wedding"}],fetchGalleryImages=async e=>{let t=await fetch("/api/gallery?event=".concat(e));return t.json()};t.default=(0,u.Z)(()=>{let[e,t]=(0,n.useState)([]),[a,u]=(0,n.useState)("all"),[x,m]=(0,n.useState)(null),[g,p]=(0,n.useState)(!1),[y,b]=(0,n.useState)(new Set),[f,w]=(0,n.useState)(!1),[j,v]=(0,n.useState)(!1),[k,N]=(0,n.useState)({current:0,total:0});(0,n.useEffect)(()=>{p(!0),fetchGalleryImages(a).then(e=>{t(e.images||[]),p(!1),b(new Set)})},[a]);let toggleSelection=e=>{let t=new Set(y);t.has(e)?t.delete(e):t.add(e),b(t)},clearSelection=()=>{b(new Set),w(!1)},handleDownload=async e=>{try{let t=await fetch(e.url),a=await t.blob(),l=window.URL.createObjectURL(a),n=document.createElement("a");n.style.display="none",n.href=l,n.download=e.name||"image.jpg",document.body.appendChild(n),n.click(),window.URL.revokeObjectURL(l),document.body.removeChild(n)}catch(e){console.error("Download failed:",e),alert("Download failed. Please try again.")}},handleBulkDownload=async()=>{if(0===y.size)return;v(!0);let t=e.filter(e=>y.has(e.id));N({current:0,total:t.length});for(let e=0;e<t.length;e++){let a=t[e];N({current:e+1,total:t.length});try{e>0&&await new Promise(e=>setTimeout(e,500)),await handleDownload(a)}catch(e){console.error("Failed to download ".concat(a.name,":"),e)}}v(!1),N({current:0,total:0}),clearSelection()},handleShare=async e=>{navigator.share?await navigator.share({url:e}):(await navigator.clipboard.writeText(e),alert("Link copied to clipboard!"))};return(0,l.jsxs)("div",{className:"min-h-screen bg-white",children:[(0,l.jsx)("div",{className:"bg-white border-b border-gray-100 sticky top-0 z-40",children:(0,l.jsxs)("div",{className:"px-4 py-3",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("button",{onClick:()=>window.history.back(),className:"p-2 -ml-2 rounded-lg hover:bg-gray-100",children:(0,l.jsx)(s.Z,{className:"w-5 h-5 text-gray-600"})}),(0,l.jsx)("h1",{className:"text-lg font-semibold text-gray-900",children:"Gallery"}),(0,l.jsx)("button",{onClick:()=>{fetch("/api/auth/logout",{method:"POST"}).then(()=>window.location.href="/login")},className:"px-3 py-1.5 text-sm bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200",children:"Logout"})]}),(0,l.jsx)("div",{className:"flex gap-1 mt-3 overflow-x-auto",children:h.map(e=>(0,l.jsx)("button",{onClick:()=>u(e.id),className:"px-3 py-1.5 text-sm rounded-lg whitespace-nowrap ".concat(a===e.id?"bg-pink-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:e.name},e.id))})]})}),f&&(0,l.jsx)("div",{className:"bg-pink-50 border-b border-pink-100 px-4 py-3",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("span",{className:"text-sm text-pink-700 font-medium",children:[y.size," selected"]}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)("button",{onClick:()=>{b(new Set(e.map(e=>e.id)))},className:"px-3 py-1.5 text-sm bg-pink-500 text-white rounded-lg",children:"All"}),(0,l.jsx)("button",{onClick:clearSelection,className:"px-3 py-1.5 text-sm bg-gray-500 text-white rounded-lg",children:"Cancel"}),y.size>0&&(0,l.jsxs)("button",{onClick:handleBulkDownload,disabled:j,className:"px-3 py-1.5 text-sm bg-green-500 text-white rounded-lg disabled:opacity-50 flex items-center gap-1",children:[(0,l.jsx)(i.Z,{className:"w-4 h-4"}),"Download"]})]})]})}),j&&(0,l.jsxs)("div",{className:"bg-blue-50 border-b border-blue-100 px-4 py-3",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,l.jsx)("span",{className:"text-sm text-blue-700 font-medium",children:"Downloading..."}),(0,l.jsxs)("span",{className:"text-sm text-blue-600",children:[k.current,"/",k.total]})]}),(0,l.jsx)("div",{className:"w-full bg-blue-200 rounded-full h-1",children:(0,l.jsx)("div",{className:"bg-blue-500 h-1 rounded-full transition-all duration-300",style:{width:"".concat(k.current/k.total*100,"%")}})})]}),(0,l.jsx)("div",{className:"px-4 py-4",children:g?(0,l.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,l.jsx)("div",{className:"text-gray-500",children:"Loading photos..."})}):0===e.length?(0,l.jsxs)("div",{className:"flex flex-col items-center justify-center py-20 text-gray-500",children:[(0,l.jsx)(r.Z,{className:"w-12 h-12 mb-4 text-gray-300"}),(0,l.jsx)("p",{children:"No photos yet"}),(0,l.jsx)("p",{className:"text-sm mt-1",children:"Photos will appear here once uploaded"})]}):(0,l.jsxs)(l.Fragment,{children:[!f&&e.length>0&&(0,l.jsx)("div",{className:"flex gap-2 mb-4",children:(0,l.jsxs)("button",{onClick:()=>w(!0),className:"px-3 py-1.5 text-sm bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 flex items-center gap-1",children:[(0,l.jsx)(c.Z,{className:"w-4 h-4"}),"Select"]})}),(0,l.jsx)("div",{className:"grid grid-cols-2 gap-3",children:e.map(e=>(0,l.jsxs)("div",{className:"relative",children:[f&&(0,l.jsx)("div",{className:"absolute top-2 left-2 z-10",onClick:()=>toggleSelection(e.id),children:y.has(e.id)?(0,l.jsx)("div",{className:"w-6 h-6 bg-pink-500 rounded-full flex items-center justify-center",children:(0,l.jsx)(o.Z,{className:"w-4 h-4 text-white"})}):(0,l.jsx)("div",{className:"w-6 h-6 bg-white/80 border-2 border-gray-300 rounded-full backdrop-blur-sm"})}),(0,l.jsxs)("div",{className:"relative aspect-square overflow-hidden rounded-xl ".concat(y.has(e.id)?"ring-2 ring-pink-500":""),onClick:()=>{f?toggleSelection(e.id):m(e.url)},children:[(0,l.jsx)("img",{src:e.url,alt:e.name,className:"w-full h-full object-cover cursor-pointer hover:scale-105 transition-transform duration-200",loading:"lazy"}),!f&&(0,l.jsx)("div",{className:"absolute inset-0 bg-black/0 hover:bg-black/20 transition-colors duration-200 group",children:(0,l.jsxs)("div",{className:"absolute bottom-2 right-2 flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:[(0,l.jsx)("button",{onClick:t=>{t.stopPropagation(),handleDownload(e)},className:"p-1.5 bg-white/90 rounded-full hover:bg-white transition-colors",title:"Download",children:(0,l.jsx)(i.Z,{className:"w-4 h-4 text-gray-700"})}),(0,l.jsx)("button",{onClick:t=>{t.stopPropagation(),handleShare(e.url)},className:"p-1.5 bg-white/90 rounded-full hover:bg-white transition-colors",title:"Share",children:(0,l.jsx)(d.Z,{className:"w-4 h-4 text-gray-700"})})]})})]})]},e.id))})]})}),x&&(0,l.jsx)("div",{className:"fixed inset-0 bg-black/90 z-50 flex items-center justify-center p-4",children:(0,l.jsxs)("div",{className:"relative max-w-full max-h-full",children:[(0,l.jsx)("button",{className:"absolute -top-12 right-0 text-white/80 hover:text-white text-2xl",onClick:()=>m(null),children:"âœ•"}),(0,l.jsx)("img",{src:x,alt:"Preview",className:"max-w-full max-h-full object-contain rounded-lg"})]})})]})})},1163:function(e,t,a){e.exports=a(9974)},8387:function(e,t,a){"use strict";a.d(t,{Z:function(){return createLucideIcon$1}});var l=a(7294),n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let toKebabCase=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();var createLucideIcon$1=(e,t)=>{let a=(0,l.forwardRef)(({color:a="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:r,children:c,...o},d)=>(0,l.createElement)("svg",{ref:d,...n,width:s,height:s,stroke:a,strokeWidth:r?24*Number(i)/Number(s):i,className:`lucide lucide-${toKebabCase(e)}`,...o},[...t.map(([e,t])=>(0,l.createElement)(e,t)),...(Array.isArray(c)?c:[c])||[]]));return a.displayName=`${e}`,a}},1590:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});var l=a(8387);let n=(0,l.Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},3079:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});var l=a(8387);let n=(0,l.Z)("CheckSquare",[["polyline",{points:"9 11 12 14 22 4",key:"19ybtz"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]])},7259:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});var l=a(8387);let n=(0,l.Z)("Check",[["polyline",{points:"20 6 9 17 4 12",key:"10jjfj"}]])},9464:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});var l=a(8387);let n=(0,l.Z)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]])},7831:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});var l=a(8387);let n=(0,l.Z)("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]])},2600:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});var l=a(8387);let n=(0,l.Z)("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]])}},function(e){e.O(0,[774,888,179],function(){return e(e.s=1707)}),_N_E=e.O()}]);