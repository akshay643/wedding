"use strict";exports.id=9823,exports.ids=[9823],exports.modules={9823:(e,r,t)=>{let s=t(9344),n=process.env.JWT_SECRET||"your-wedding-secret-key-change-this",u=process.env.WEDDING_PASSCODE||"Akshay&Tripti2025",i=process.env.ADMIN_PASSCODE||"Admin@Wedding2025",verifyToken=e=>{try{return s.verify(e,n)}catch(e){return null}},checkAuth=e=>{let r=e.cookies?.authToken||e.headers.authorization?.replace("Bearer ","");if(!r)return{authenticated:!1,user:null};let t=verifyToken(r);return t?{authenticated:!0,user:t}:{authenticated:!1,user:null}};e.exports={verifyToken,generateToken:e=>s.sign(e,n,{expiresIn:"7d"}),checkAuth,verifyPasscode:e=>e===u,verifyAdminPasscode:e=>e===i,withAuth:e=>async(r,t)=>{try{let s=checkAuth(r);if(!s.authenticated)return t.status(401).json({success:!1,error:"Authentication required"});return r.user=s.user,await e(r,t)}catch(e){return console.error("Auth middleware error:",e),t.status(500).json({success:!1,error:"Authentication error"})}},PASSCODES:{WEDDING_PASSCODE:u,ADMIN_PASSCODE:i}}}};