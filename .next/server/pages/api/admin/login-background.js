"use strict";(()=>{var e={};e.id=197,e.ids=[197],e.modules={9344:e=>{e.exports=require("jsonwebtoken")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},7147:e=>{e.exports=require("fs")},1017:e=>{e.exports=require("path")},8055:(e,r,t)=>{t.r(r),t.d(r,{config:()=>c,default:()=>g,routeModule:()=>p});var i={};t.r(i),t.d(i,{default:()=>handler});var o=t(1802),n=t(7153),a=t(6249);let{checkAuth:l}=t(9823),s=t(7147).promises,u=t(1017),d=u.join(process.cwd(),"login-config.json");async function handler(e,r){try{if("GET"===e.method)try{let e=await s.readFile(d,"utf8"),t=JSON.parse(e),i=t.backgroundImage||"/wedding-couple.png",o={imageUrl:i,originalUrl:t.originalUrl||i,fileId:t.fileId||null};return console.log("API - Returning background image URL:",i),r.status(200).json(o)}catch(e){return console.error("API - Error reading config file:",e),r.status(200).json({imageUrl:"/wedding-couple.png"})}if("POST"===e.method){let{authenticated:t}=l(e);if(!t)return r.status(401).json({error:"Authentication required"});let{imageUrl:i}=e.body;if(!i)return r.status(400).json({error:"Image URL is required"});let o=i,n=null,a=i.match(/drive\.google\.com\/(?:file\/d\/|open\?id=|uc\?.*?id=|thumbnail\?.*?id=)([\w-]+)/);a&&a[1]&&(n=a[1],o=`https://drive.google.com/uc?export=download&id=${n}`);let u={backgroundImage:o,originalUrl:i,fileId:n,updatedAt:new Date().toISOString()};return await s.writeFile(d,JSON.stringify(u,null,2)),await s.writeFile(d,JSON.stringify(u,null,2)),r.status(200).json({success:!0,message:"Background image updated successfully",imageUrl:o})}return r.status(405).json({error:"Method not allowed"})}catch(e){return console.error("Login background API error:",e),r.status(500).json({error:"Internal server error"})}}let g=(0,a.l)(i,"default"),c=(0,a.l)(i,"config"),p=new o.PagesAPIRouteModule({definition:{kind:n.x.PAGES_API,page:"/api/admin/login-background",pathname:"/api/admin/login-background",bundlePath:"",filename:""},userland:i})}};var r=require("../../../webpack-api-runtime.js");r.C(e);var __webpack_exec__=e=>r(r.s=e),t=r.X(0,[4222,9823],()=>__webpack_exec__(8055));module.exports=t})();